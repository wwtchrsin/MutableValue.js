var MutableValue=function(u){function o(n,t,e,o){(function(n,t,e){for(var o=0;o<n.length;o++)if(n[o][0]===t&&n[o][1]===e)return o;return-1})(n,t,e)<0&&n.push([t,e,!0,o])}function t(n,t,e){for(var o=0;o<g.length;o++)for(var r=0;r<g[o].length;r++)!e&&g[o][r][1]!==t||(g[o][r][2]=n)}function r(n){arguments.length<1&&(n=u);for(var t=n,e=0;e<c.length;e++){var o=c[e];o[2]&&(t=o[3]?o[0].call(o[1],t,n):o[0](t,n))}return t}function e(n,t,e){arguments.length<1&&(n=u);for(var o=0;o<i.length;o++){var r=i[o];(e||r[1]===t)&&r[2]&&(r[3]?r[0].call(r[1],n):r[0](n))}}var l=this,f=[],a=[],c=[],i=[],g=[f,a,c,i];l.OnAssigning=function(n,t,e){o(f,n,t,e=!0===e)},l.OnChange=function(n,t,e){o(a,n,t,e=!0===e)},l.OnReporting=function(n,t,e){o(c,n,t,e=!0===e)},l.GetValue=function(n,t,e){o(i,n,t,e=!0===e),e?n.call(t,r()):n(r())},l.TraceValue=function(n,t,e){return"function"!=typeof n||o(i,n,t,e=!0===e),r()},l.SetValue=function(n){!function(n){for(var t=0;t<f.length;t++){var e,o=f[t];if(o[2]&&(e=o[3]?o[0].call(o[1],n):o[0](n)),!1===e)return!1}return!0}(n)||(u=function(n){for(var t=0;t<a.length;t++){var e,o=a[t];o[2]&&(e=o[3]?o[0].call(o[1],n,u):o[0](n,u)),void 0!==e&&(n=e)}return n}(n),e(r(),void 0,!0))},l.ModifyValue=function(n){l.SetValue(n(u))},l.PassValue=function(n){var t=0===arguments.length;e(r(),n,t)},l.Connect=function(n){t(!0,n,0===arguments.length)},l.Disconn=function(n){t(!1,n,0===arguments.length)},l.ReleaseAll=function(){g=[f=[],a=[],c=[],i=[]]},l.Release=function(n){!function(n){for(var t=0;t<g.length;t++)for(var e=0;e<g[t].length;e++)g[t][e][1]===n&&g[t].splice(e--,1)}(n)}};"object"==typeof exports&&"object"==typeof module&&(module.exports=MutableValue);